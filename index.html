<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Diablo: The Absolute Sovereign</title>
    <style>
        :root {
            --gold: #ffd700; --red: #ff3e3e; --blue: #00d4ff; --bg: #010101;
            --panel: rgba(12, 12, 12, 0.99); --neon: 0 0 20px var(--gold);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); color: white; font-family: 'Segoe UI', Tahoma, sans-serif; overflow: hidden; }

        /* Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨ØµØ±ÙŠ - ÙØµÙ„ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª */
        .layer {
            position: absolute; width: 100%; height: 100%;
            display: none; flex-direction: column;
            background: var(--bg); z-index: 10;
        }
        .active { display: flex; animation: viewIn 0.6s cubic-bezier(0.23, 1, 0.32, 1); }
        @keyframes viewIn { from { opacity: 0; transform: scale(1.1); } to { opacity: 1; transform: scale(1); } }

        /* Ø§Ù„Ø³Ù‡Ù… Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø§Ù„ÙØ§Ø¦Ù‚ */
        #side-deck {
            position: fixed; left: -320px; top: 0; width: 320px; height: 100%;
            background: var(--panel); border-right: 3px solid var(--gold);
            z-index: 10000; transition: 0.6s cubic-bezier(0.19, 1, 0.22, 1);
            padding: 25px; box-shadow: 20px 0 60px rgba(0,0,0,0.95);
        }
        #side-deck.open { left: 0; }
        .deck-handle {
            position: absolute; right: -45px; top: 15%; width: 45px; height: 110px;
            background: var(--gold); color: black; cursor: pointer;
            border-radius: 0 12px 12px 0; display: flex; align-items: center; justify-content: center;
            font-weight: bold; writing-mode: vertical-rl; letter-spacing: 2px;
        }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© ÙˆØ§Ù„Ø¯ÙˆØ§Ø¦Ø± */
        .map-section { flex: 1; display: flex; justify-content: center; align-items: center; padding: 10px; }
        .map-frame { position: relative; border: 3px solid #222; border-radius: 25px; overflow: hidden; box-shadow: 0 0 50px #000; }
        .map-img { max-width: 95vw; max-height: 75vh; border-radius: 20px; display: block; }
        
        .node {
            position: absolute; width: 16px; height: 16px; 
            background: rgba(0,0,0,0.8); border: 2px solid var(--gold);
            border-radius: 50%; transform: translate(-50%, -50%); cursor: pointer;
            transition: 0.4s; z-index: 100; animation: pulseGlow 2s infinite;
        }
        @keyframes pulseGlow { 0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.8); } 70% { box-shadow: 0 0 0 12px rgba(255, 215, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); } }
        .node:hover { transform: translate(-50%, -50%) scale(1.8); background: var(--gold); box-shadow: 0 0 20px var(--gold); }
        .node-boss { border-color: var(--red); width: 22px; height: 22px; animation-duration: 1s; }

        /* Ø³Ø§Ø­Ø© Ø§Ù„Ù‚ØªØ§Ù„ Ø§Ù„Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠØ© */
        .battle-view { flex: 1; display: flex; flex-direction: column; background: radial-gradient(circle at center, #200000 0%, #000 100%); }
        .fighter-zone { flex: 1; display: flex; justify-content: space-around; align-items: center; padding: 20px; position: relative; }
        .warrior { text-align: center; width: 45%; transition: 0.5s; }
        .warrior img { width: 130px; height: 130px; border-radius: 50%; border: 4px solid var(--gold); box-shadow: var(--neon); object-fit: cover; }
        .warrior.enemy img { border-color: var(--red); box-shadow: 0 0 20px var(--red); }
        
        /* Ø£Ø´Ø±Ø·Ø© Ø§Ù„Ø­Ø§Ù„Ø© */
        .gauge { width: 100%; height: 24px; background: #000; border: 1px solid #333; border-radius: 12px; margin-top: 12px; position: relative; overflow: hidden; box-shadow: inset 0 0 10px rgba(0,0,0,0.5); }
        .gauge-fill { height: 100%; width: 100%; transition: 1s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .hp-player { background: linear-gradient(90deg, #00ff00, #005500); }
        .hp-enemy { background: linear-gradient(90deg, #ff0000, #550000); }
        .gauge-txt { position: absolute; width: 100%; text-align: center; font-size: 13px; top: 3px; font-weight: bold; text-shadow: 1px 1px 2px #000; color: white; }

        /* Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„ (Ø³Ø¬Ù„ Ø§Ù„Ù‚ØªØ§Ù„) */
        .console-log { height: 120px; background: #050505; border-top: 2px solid #1a1a1a; padding: 15px; overflow-y: auto; color: #00ff00; font-family: 'Consolas', monospace; font-size: 13px; line-height: 1.6; }

        /* Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .deck-header { color: var(--gold); font-size: 18px; font-weight: bold; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; text-align: center; }
        .skill-btn {
            background: #111; border: 1px solid #444; padding: 15px; border-radius: 12px;
            margin-bottom: 12px; cursor: pointer; transition: 0.3s; position: relative; overflow: hidden;
        }
        .skill-btn:hover:not(.locked) { border-color: var(--gold); background: #1a1a1a; transform: scale(1.02); }
        .skill-btn.locked { opacity: 0.3; cursor: not-allowed; filter: grayscale(1); }
        .skill-name { display: block; color: var(--gold); font-weight: bold; font-size: 15px; }
        .skill-type { font-size: 10px; color: #888; background: #222; padding: 2px 5px; border-radius: 4px; margin-right: 5px; }
        .cd-bar { position: absolute; left: 0; bottom: 0; height: 4px; background: var(--red); transition: 0.3s; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn-action { background: var(--gold); color: black; border: none; padding: 12px 25px; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-action:hover { box-shadow: 0 0 15px var(--gold); }

        /* Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠØ© */
        .shake { animation: shakeEffect 0.5s; }
        @keyframes shakeEffect { 0%, 100% { transform: translate(0,0); } 20% { transform: translate(-8px, 0); } 40% { transform: translate(8px, 0); } 60% { transform: translate(-4px, 0); } }
    </style>
</head>
<body>

    <div id="side-deck">
        <div class="deck-handle" onclick="toggleDeck()">LEGENDS â˜°</div>
        <div id="deck-content"></div>
    </div>

    <div id="scr-auth" class="layer active" style="justify-content:center; align-items:center;">
        <div style="background:#0a0a0a; padding:45px; border:2px solid var(--gold); border-radius:25px; text-align:center; width: 85%; box-shadow: var(--neon);">
            <h1 style="color:var(--gold); margin:0; letter-spacing:3px;">DIABLO SOVEREIGN</h1>
            <p style="color:#444; font-size:11px; margin-bottom:25px;">INITIALIZING BIOMETRIC AUTHENTICATION</p>
            <input type="password" id="pass-input" style="width:100%; padding:18px; background:#000; color:var(--gold); border:1px solid #222; text-align:center; margin-bottom:25px; border-radius:12px; font-size:20px;">
            <button class="btn-action" onclick="validateAuth()" style="width:100%;">ACCESS SYSTEM</button>
        </div>
    </div>

    <div id="scr-map" class="layer">
        <div style="padding:15px; background:#0a0a0a; border-bottom:1px solid var(--gold); display:flex; justify-content:space-between; align-items:center;">
            <span><b id="p-rank-label" style="color:var(--gold);">Ø±ØªØ¨Ø©: Ù…Ø¨ØªØ¯Ø¦</b> | Ø¯ÙŠØ§Ø¨Ù„Ùˆ</span>
            <span style="color:var(--gold); font-weight:bold;">Ø§Ù„Ø°Ù‡Ø¨: <span id="p-gold-count">100</span></span>
        </div>
        <div class="map-section">
            <div class="map-frame">
                <img src="20260129_152721.jpg" class="map-img">
                <div class="node" style="top:20%; left:50%;" onclick="alert('Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ')"></div>
                <div class="node node-boss" style="top:30%; left:78%;" onclick="initCombat('ØºÙŠÙˆØªØ§Ø±Ùˆ')"></div>
                <div class="node" style="top:58%; left:88%;" onclick="alert('Ø§Ù„Ù…ØªØ¬Ø±')"></div>
            </div>
        </div>
    </div>

    <div id="scr-battle" class="layer">
        <div class="battle-view" id="battle-arena">
            <div class="fighter-zone">
                <div class="warrior" id="p-warrior">
                    <img src="https://via.placeholder.com/150/000/FFD700?text=DIABLO" alt="Diablo">
                    <div style="margin-top:8px; font-weight:bold;">Ø¯ÙŠØ§Ø¨Ù„Ùˆ</div>
                    <div class="gauge"><div id="p-hp-bar" class="gauge-fill hp-player"></div><div class="gauge-txt" id="p-hp-txt">1000/1000</div></div>
                </div>
                <div style="font-size:30px; font-weight:bold; color:var(--gold); text-shadow:0 0 10px var(--gold);">VS</div>
                <div class="warrior enemy" id="e-warrior">
                    <img src="https://via.placeholder.com/150/000/FF3E3E?text=GYUTARO" alt="Enemy">
                    <div id="e-name" style="margin-top:8px; font-weight:bold; color:var(--red);">ØºÙŠÙˆØªØ§Ø±Ùˆ</div>
                    <div class="gauge"><div id="e-hp-bar" class="gauge-fill hp-enemy"></div><div class="gauge-txt" id="e-hp-txt">1500/1500</div></div>
                </div>
            </div>
            <div id="combat-log" class="console-log"></div>
            <center><button class="btn-action" style="background:#222; color:white; margin-bottom:20px;" onclick="surrender()">Ø§Ù†Ø³Ø­Ø§Ø¨</button></center>
        </div>
    </div>

    <script>
        // --- Ù…Ø­Ø±Ùƒ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø·Ù„Ù‚ (Sovereign Engine) ---
        const _P = "MTIz"; 
        let Diablo = {
            gold: 100, wins: 0, rank: "Ù…Ø¨ØªØ¯Ø¦", 
            hp: 1000, mhp: 1000, 
            shield: false, lock: false,
            skills: [
                { id: 'atk', name: 'Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù„Ù…', type: 'Ø¶Ø±Ø¨Ø© Ù„Ø§ ØªÙØµØ¯', cd: 0, mcd: 3, val: 400 },
                { id: 'shd', name: 'Ø­Ø§Ø¬Ø² Ø§Ù„Ù‡Ø§ÙˆÙŠØ©', type: 'ØªØ¹Ø²ÙŠØ²', cd: 0, mcd: 4, val: 0 },
                { id: 'mind', name: 'Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¹Ù‚ÙˆÙ„', type: 'ØªØ­ÙƒÙ…', cd: 0, mcd: 3, val: 150 },
                { id: 'abs', name: 'Ù…Ø§Ù†Ø¯Ø§Ù„Ø§ Ø§Ù„Ø¯Ù…', type: 'Ø§Ù…ØªØµØ§Øµ', cd: 0, mcd: 5, val: 200, locked: true }
            ]
        };

        let Boss = { name: "ØºÙŠÙˆØªØ§Ø±Ùˆ", hp: 1500, mhp: 1500, atk: 180 };

        function validateAuth() {
            if(btoa(document.getElementById('pass-input').value) === _P) {
                switchLayer('scr-map');
                refreshDeck('map');
            } else { alert("ACCESS DENIED!"); }
        }

        function switchLayer(id) {
            document.querySelectorAll('.layer').forEach(l => l.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function toggleDeck() { document.getElementById('side-deck').classList.toggle('open'); }

        function refreshDeck(mode) {
            const body = document.getElementById('deck-content');
            if(mode === 'map') {
                body.innerHTML = `
                    <div class="deck-header">Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø³ÙŠØ§Ø¯Ø©</div>
                    <p>Ø§Ù„Ù…ØºØ§Ù…Ø±: <b>Ø¯ÙŠØ§Ø¨Ù„Ùˆ</b></p>
                    <p>Ø§Ù„Ø±ØªØ¨Ø©: <b style="color:gold;">${Diablo.rank}</b></p>
                    <p>Ø§Ù„Ø°Ù‡Ø¨: <b style="color:gold;">${Diablo.gold}</b></p>
                    <hr style="border:1px solid #222;">
                    <p style="font-size:12px; color:#666;">Ø§Ù„Ù…Ù‡Ù…Ø§Øª: Ù‡Ø²ÙŠÙ…Ø© ØºÙŠÙˆØªØ§Ø±Ùˆ ÙˆØ§ÙØªØ±Ø§Ø³ Ù‚ÙˆØªÙ‡.</p>
                `;
            } else {
                let html = `<div class="deck-header">Ù…Ù†ØµØ© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</div>`;
                Diablo.skills.forEach(s => {
                    html += `
                        <div class="skill-btn ${s.locked ? 'locked' : ''} ${s.cd > 0 ? 'cd' : ''}" onclick="triggerSkill('${s.id}')">
                            <span class="skill-name">${s.name} ${s.locked ? 'ğŸ”’' : ''}</span>
                            <span class="skill-type">${s.type}</span>
                            ${s.cd > 0 ? `<div class="cd-bar" style="width:${(s.cd/s.mcd)*100}%"></div>` : ''}
                        </div>
                    `;
                });
                body.innerHTML = html;
            }
        }

        // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚ØªØ§Ù„ ---
        function initCombat(name) {
            Boss.hp = Boss.mhp; Diablo.hp = Diablo.mhp; Diablo.lock = false;
            Diablo.skills.forEach(s => s.cd = 0);
            document.getElementById('combat-log').innerHTML = "";
            updateVisuals();
            switchLayer('scr-battle');
            refreshDeck('battle');
            log(`Ø¯ÙŠØ§Ø¨Ù„Ùˆ ÙŠÙˆØ§Ø¬Ù‡ ${name} ÙÙŠ Ø³Ø§Ø­Ø© Ø§Ù„Ù‚Ø¯Ø±..`);
        }

        function triggerSkill(id) {
            if(Diablo.lock) return;
            const s = Diablo.skills.find(x => x.id === id);
            if(s.locked || s.cd > 0) return;

            Diablo.lock = true;
            s.cd = s.mcd;
            
            if(id === 'atk') {
                Boss.hp -= s.val;
                log(`Ø¯ÙŠØ§Ø¨Ù„Ùˆ: [${s.name}]! Ø¶Ø±Ø±: ${s.val}`);
                shake('e-warrior');
            } else if(id === 'shd') {
                Diablo.shield = true;
                log(`ØªÙ… ØªÙØ¹ÙŠÙ„ [${s.name}].. Ø¯ÙŠØ§Ø¨Ù„Ùˆ Ù…Ù†ÙŠØ¹ Ø§Ù„Ø¢Ù†.`);
            } else if(id === 'mind') {
                Boss.hp -= s.val;
                log(`[Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¹Ù‚ÙˆÙ„]: ØºÙŠÙˆØªØ§Ø±Ùˆ ÙŠÙ‡Ø§Ø¬Ù… Ù†ÙØ³Ù‡! Ø¶Ø±Ø±: ${s.val}`);
            } else if(id === 'abs') {
                Boss.hp -= s.val; Diablo.hp = Math.min(Diablo.mhp, Diablo.hp + s.val);
                log(`[Ø§Ù…ØªØµØ§Øµ]: ØªÙ… Ø³Ø­Ø¨ Ø­ÙŠØ§Ø© Ø§Ù„Ø®ØµÙ…! Ø§Ø³ØªØ¹Ø§Ø¯Ø©: ${s.val}`);
            }

            updateVisuals();
            refreshDeck('battle');
            if(Boss.hp <= 0) return victory();
            setTimeout(bossTurn, 1000);
        }

        function bossTurn() {
            let d = Diablo.shield ? 0 : Boss.atk;
            Diablo.hp -= d;
            log(Diablo.shield ? "ØºÙŠÙˆØªØ§Ø±Ùˆ: Ø§Ù„Ù„Ø¹Ù†Ø©! Ø¯Ø±Ø¹ Ø¯ÙŠØ§Ø¨Ù„Ùˆ Ù„Ø§ ÙŠÙƒØ³Ø±." : `ØºÙŠÙˆØªØ§Ø±Ùˆ: Ù…Ø§Ù†Ø¯Ø§Ù„Ø§ Ø§Ù„Ø¯Ù…! Ø¶Ø±Ø±: ${d}`);
            if(d > 0) shake('p-warrior');
            
            Diablo.shield = false; Diablo.lock = false;
            Diablo.skills.forEach(s => { if(s.cd > 0) s.cd--; });
            
            updateVisuals();
            refreshDeck('battle');
            if(Diablo.hp <= 0) { alert("Ù‡Ø²ÙŠÙ…Ø© Ø¯ÙŠØ§Ø¨Ù„Ùˆ.."); surrender(); }
        }

        function victory() {
            log("Ù†ØµØ± Ø³Ø§Ø­Ù‚! Ø¯ÙŠØ§Ø¨Ù„Ùˆ ÙŠÙØªØ±Ø³ Ø±ÙˆØ­ ØºÙŠÙˆØªØ§Ø±Ùˆ..");
            Diablo.gold += 500; Diablo.wins++;
            // Ù†Ø¸Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø³
            Diablo.skills.find(s => s.id === 'abs').locked = false; 
            // Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ØªØ¨
            if(Diablo.wins >= 1) { Diablo.rank = "Ø´ÙŠØ·Ø§Ù† Ø¹Ø¸ÙŠÙ…"; Diablo.mhp = 1200; }
            alert("ØªÙ… Ø§Ù„Ù†ØµØ±! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ù…Ù‡Ø§Ø±Ø© 'Ù…Ø§Ù†Ø¯Ø§Ù„Ø§ Ø§Ù„Ø¯Ù…' Ø¨Ø§Ù„Ø§ÙØªØ±Ø§Ø³.");
            surrender();
        }

        function updateVisuals() {
            document.getElementById('p-hp-bar').style.width = (Diablo.hp/Diablo.mhp*100) + "%";
            document.getElementById('e-hp-bar').style.width = (Boss.hp/Boss.mhp*100) + "%";
            document.getElementById('p-hp-txt').innerText = `${Diablo.hp}/${Diablo.mhp}`;
            document.getElementById('e-hp-txt').innerText = `${Boss.hp}/${Boss.mhp}`;
            document.getElementById('p-gold-count').innerText = Diablo.gold;
            document.getElementById('p-rank-label').innerText = "Ø±ØªØ¨Ø©: " + Diablo.rank;
        }

        function log(m) {
            const l = document.getElementById('combat-log');
            l.innerHTML = `<div>> ${m}</div>` + l.innerHTML;
            l.scrollTop = 0;
        }

        function shake(id) {
            const el = document.getElementById(id);
            el.classList.add('shake');
            setTimeout(() => el.classList.remove('shake'), 500);
        }

        function surrender() { switchLayer('scr-map'); refreshDeck('map'); }
    </script>
</body>
</html>
